# NAVO RADIO — Новая архитектура (ubuntu-with-admin)

## Идея

Эфир = заранее сгенерированный плейлист на день. Админ генерирует, редактирует, озвучивает — полный контроль до выхода в эфир.

## Сущности

| Тип | Источник | Текст | Озвучка |
|-----|----------|------|---------|
| **Песня** | Jamendo API | — | Скачивается сразу |
| **DJ** | Groq | Да, редактируемый | TTS |
| **Новости** | RSS + Groq | Да, редактируемый | TTS |
| **Погода** | API + Groq | Да, редактируемый | TTS |
| **Подкаст** | Файл mp3/mp4 | — | Готовый файл |
| **Интро** | Файл mp3 | — | Готовый файл |

## Workflow

1. **Сгенерировать эфир** — создаётся последовательность с текстами (DJ, новости, погода), песни скачиваются
2. **Редактировать** — админ правит тексты в таблице
3. **Озвучить эфир** — TTS для всех текстовых сущностей
4. **Озвучить выбранное** — TTS только для отмеченных
5. **Изменить порядок** — кнопки ↑↓ (drag-drop позже)
6. **Стриминг** — в 00:00 МСК playback engine загружает плейлист и стримит в Icecast

## Запуск

```bash
# 1. Icecast
start-icecast.bat

# 2. API + Playback
start-admin.bat

# 3. Фронтенд (отдельно)
cd online-radio-page && npm run dev
```

- API: http://localhost:8001
- Админка: http://localhost:3000/admin
- Плеер: http://localhost:3000

## Структура

```
data/
├── playlists/       # JSON плейлисты по дням (YYYY-MM-DD.json)
└── cache/
    ├── songs/       # Скачанные треки Jamendo
    └── tts/         # Озвученные тексты

backend/
├── api_main.py      # FastAPI для админки
├── playback_engine.py  # Стриминг по плейлисту в 00:00 МСК
├── playlist_generator.py
├── playlist_store.py
└── schemas.py
```
